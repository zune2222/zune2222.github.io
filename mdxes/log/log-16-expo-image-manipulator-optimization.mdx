---
title: "React Native ì´ë¯¸ì§€ ìµœì í™” ì™„ë²½ í•´ê²°: expo-image-manipulatorë¡œ 5MB â†’ 50KB ì‹¤ì‹œê°„ ì••ì¶•í•˜ê¸°"
date: "2025-06-18"
description: "5-15MB ì´ë¯¸ì§€ ë•Œë¬¸ì— í™”ë©´ ì „í™˜ì´ ë²„ë²…ê±°ë ¸ë‹¤. expo-image-manipulatorë¡œ ì‹¤ì‹œê°„ ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§•ê³¼ AsyncStorage ìºì‹±ì„ êµ¬í˜„í•´ 99% ìš©ëŸ‰ì„ ì¤„ì¸ ê³¼ì •ì„ ê³µìœ í•œë‹¤."
---

React Native ì•±ì—ì„œ ê³ í™”ì§ˆ ì´ë¯¸ì§€ë¡œ ì¸í•œ ì„±ëŠ¥ ë¬¸ì œëŠ” ê°œë°œìë“¤ì˜ ì˜ì›í•œ ìˆ™ì œë‹¤. 5-15MBì— ë‹¬í•˜ëŠ” ì´ë¯¸ì§€ë“¤ì´ í™”ë©´ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ì„ ë§ì¹˜ê³  ìˆì—ˆë‹¤. Firebase Storage URL íŒŒë¼ë¯¸í„° ê°™ì€ ë°©ë²•ë„ ì‹œë„í•´ë´¤ì§€ë§Œ, ê²°êµ­ **expo-image-manipulator**ë¡œ ì§„ì§œ í•´ê²°ì±…ì„ ì°¾ì•˜ë‹¤.

## ë¬¸ì œ: ê±°ëŒ€í•œ ì´ë¯¸ì§€ê°€ ì•±ì„ ëŠë¦¬ê²Œ ë§Œë“ ë‹¤

```javascript
// ê¸°ì¡´ ì½”ë“œ - ì›ë³¸ ì´ë¯¸ì§€ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©
<Image 
  source={{ uri: item.coverImageURL }} // ğŸ˜± 5-15MB ì›ë³¸!
  style={styles.coverImage}
/>
```

ì´ëŸ° ìƒí™©ì´ ë°œìƒí–ˆë‹¤:
- íƒ­ ì „í™˜ ì‹œ ì‹¬ê°í•œ ë™
- ë¦¬ìŠ¤íŠ¸ ìŠ¤í¬ë¡¤ ë²„ë²…ê±°ë¦¼
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í­ì¦
- ì´ë¯¸ì§€ ë¡œë”© ì‹œê°„ 3-5ì´ˆ

## í•´ê²°ì±…: useOptimizedImage ì»¤ìŠ¤í…€ í›…

expo-image-manipulatorë¥¼ í™œìš©í•´ ì‹¤ì‹œê°„ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ì••ì¶•í•˜ê³ , AsyncStorageë¡œ ìºì‹±í•˜ëŠ” ì»¤ìŠ¤í…€ í›…ì„ ë§Œë“¤ì—ˆë‹¤.

```javascript
import * as ImageManipulator from 'expo-image-manipulator';
import AsyncStorage from '@react-native-async-storage/async-storage';
import { useEffect, useState } from 'react';

interface UseOptimizedImageOptions {
  width: number;
  height: number;
  quality: number;
  format?: ImageManipulator.SaveFormat;
}

export function useOptimizedImage(
  originalUri: string | undefined,
  itemId: string,
  options: UseOptimizedImageOptions
) {
  const [optimizedUri, setOptimizedUri] = useState<string | null>(null);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const { width, height, quality, format = ImageManipulator.SaveFormat.JPEG } = options;

  useEffect(() => {
    if (!originalUri || originalUri.includes('placeholder')) {
      setOptimizedUri(originalUri || null);
      return;
    }

    const optimizeImage = async () => {
      try {
        setIsLoading(true);
        setError(null);

        // ìºì‹œ í‚¤ ìƒì„±
        const cacheKey = `optimized_${itemId}_${width}x${height}_${quality}`;
        
        // ìºì‹œì—ì„œ í™•ì¸
        const cached = await AsyncStorage.getItem(cacheKey);
        if (cached) {
          setOptimizedUri(cached);
          setIsLoading(false);
          return;
        }

        // ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§• ë° ì••ì¶•
        const result = await ImageManipulator.manipulateAsync(
          originalUri,
          [{ resize: { width, height } }],
          {
            compress: quality,
            format,
            base64: false,
          }
        );

        // ìºì‹œì— ì €ì¥
        await AsyncStorage.setItem(cacheKey, result.uri);
        setOptimizedUri(result.uri);
      } catch (err) {
        console.error('ì´ë¯¸ì§€ ìµœì í™” ì‹¤íŒ¨:', err);
        setError('ì´ë¯¸ì§€ ìµœì í™” ì‹¤íŒ¨');
        // ì‹¤íŒ¨ì‹œ ì›ë³¸ ì´ë¯¸ì§€ ì‚¬ìš©
        setOptimizedUri(originalUri);
      } finally {
        setIsLoading(false);
      }
    };

    optimizeImage();
  }, [originalUri, itemId, width, height, quality, format]);

  return {
    optimizedUri,
    isLoading,
    error,
  };
}
```

## í•µì‹¬ ê¸°ëŠ¥ ë¶„ì„

### 1. ìŠ¤ë§ˆíŠ¸ ìºì‹± ì‹œìŠ¤í…œ
```javascript
// ìºì‹œ í‚¤ ìƒì„±: ì•„ì´í…œ ID + í¬ê¸° + í’ˆì§ˆ
const cacheKey = `optimized_${itemId}_${width}x${height}_${quality}`;

// AsyncStorageì—ì„œ ë¨¼ì € í™•ì¸
const cached = await AsyncStorage.getItem(cacheKey);
if (cached) {
  setOptimizedUri(cached);
  return; // ìºì‹œ íˆíŠ¸! ì¦‰ì‹œ ë°˜í™˜
}
```

### 2. ì‹¤ì‹œê°„ ì´ë¯¸ì§€ ë³€í™˜
```javascript
// expo-image-manipulatorë¡œ ë¦¬ì‚¬ì´ì§• & ì••ì¶•
const result = await ImageManipulator.manipulateAsync(
  originalUri,
  [{ resize: { width: 200, height: 150 } }], // ë¦¬ì‚¬ì´ì§•
  {
    compress: 0.7,  // 70% í’ˆì§ˆë¡œ ì••ì¶•
    format: ImageManipulator.SaveFormat.JPEG,
    base64: false,  // base64 ëŒ€ì‹  íŒŒì¼ URI ì‚¬ìš© (ì„±ëŠ¥ìƒ ìœ ë¦¬)
  }
);
```

### 3. ì—ëŸ¬ ì²˜ë¦¬
```javascript
// ìµœì í™” ì‹¤íŒ¨ ì‹œ ì›ë³¸ ì´ë¯¸ì§€ í´ë°±
catch (err) {
  console.error('ì´ë¯¸ì§€ ìµœì í™” ì‹¤íŒ¨:', err);
  setOptimizedUri(originalUri); // ì›ë³¸ìœ¼ë¡œ í´ë°±
}
```

## ì‹¤ì œ ì‚¬ìš© ì˜ˆì‹œ

### Letter Item ì»´í¬ë„ŒíŠ¸ì— ì ìš©
```javascript
import { useOptimizedImage } from '@/hooks/useOptimizedImage';

function LetterItem({ item }) {
  const { optimizedUri, isLoading } = useOptimizedImage(
    item.coverImageURL,
    item.id,
    {
      width: 200,
      height: 150,
      quality: 0.7, // 70% í’ˆì§ˆ
    }
  );

  return (
    <View style={styles.container}>
      {isLoading ? (
        <View style={styles.placeholder}>
          <Text>ë¡œë”©ì¤‘...</Text>
        </View>
      ) : (
        <Image 
          source={{ uri: optimizedUri }}
          style={styles.coverImage}
          resizeMode="cover"
        />
      )}
      <Text>{item.title}</Text>
    </View>
  );
}
```

### FlatListì—ì„œ ì‚¬ìš©
```javascript
function LetterList({ letters }) {
  return (
    <FlatList
      data={letters}
      renderItem={({ item }) => (
        <LetterItem item={item} />
      )}
      keyExtractor={item => item.id}
      // ìµœì í™”ëœ ì´ë¯¸ì§€ë¡œ ìŠ¤í¬ë¡¤ ì„±ëŠ¥ í–¥ìƒ!
      removeClippedSubviews={true}
      maxToRenderPerBatch={10}
      windowSize={10}
    />
  );
}
```

## ì„±ëŠ¥ ì¸¡ì • ê²°ê³¼

### Before (ì›ë³¸ ì´ë¯¸ì§€)
```
- íŒŒì¼ í¬ê¸°: 5-15MB
- ë¡œë”© ì‹œê°„: 3-5ì´ˆ
- ë©”ëª¨ë¦¬ ì‚¬ìš©: ì´ë¯¸ì§€ë‹¹ 40-60MB
- í™”ë©´ ì „í™˜: ëˆˆì— ë„ëŠ” ë™
- FlatList ìŠ¤í¬ë¡¤: ë²„ë²…ê±°ë¦¼
```

### After (ìµœì í™”ëœ ì´ë¯¸ì§€)
```
- íŒŒì¼ í¬ê¸°: 50-100KB (99% ê°ì†Œ!)
- ì²« ë¡œë”©: 0.5-1ì´ˆ (ë¦¬ì‚¬ì´ì§• ì‹œê°„)
- ìºì‹œ ë¡œë”©: ì¦‰ì‹œ (0.01ì´ˆ ë¯¸ë§Œ)
- ë©”ëª¨ë¦¬ ì‚¬ìš©: ì´ë¯¸ì§€ë‹¹ 2-5MB
- í™”ë©´ ì „í™˜: ì™„ì „íˆ ë¶€ë“œëŸ¬ì›€
- FlatList ìŠ¤í¬ë¡¤: ë§¤ë„ëŸ¬ì›€
```

## ê³ ê¸‰ í™œìš© íŒ

### 1. ë‹¤ì–‘í•œ í¬ê¸° ì˜µì…˜ ì œê³µ
```javascript
// ì¸ë„¤ì¼ í¬ê¸° í”„ë¦¬ì…‹
const IMAGE_SIZES = {
  thumbnail: { width: 150, height: 150, quality: 0.6 },
  small: { width: 300, height: 225, quality: 0.7 },
  medium: { width: 600, height: 450, quality: 0.8 },
  large: { width: 1200, height: 900, quality: 0.9 },
};

// ì‚¬ìš©
const { optimizedUri } = useOptimizedImage(
  imageUrl,
  itemId,
  IMAGE_SIZES.thumbnail
);
```

### 2. Progressive Loading êµ¬í˜„
```javascript
function ProgressiveImage({ source, itemId }) {
  // ë¨¼ì € ì‘ì€ ì¸ë„¤ì¼ ë¡œë“œ
  const thumbnail = useOptimizedImage(source, itemId, {
    width: 50,
    height: 50,
    quality: 0.3,
  });
  
  // ê·¸ ë‹¤ìŒ ê³ í™”ì§ˆ ì´ë¯¸ì§€ ë¡œë“œ
  const fullImage = useOptimizedImage(source, itemId, {
    width: 400,
    height: 300,
    quality: 0.8,
  });

  return (
    <View>
      {/* ë¸”ëŸ¬ ì²˜ë¦¬ëœ ì¸ë„¤ì¼ ë¨¼ì € í‘œì‹œ */}
      <Image 
        source={{ uri: thumbnail.optimizedUri }}
        style={[styles.image, { opacity: fullImage.isLoading ? 1 : 0 }]}
        blurRadius={10}
      />
      {/* ê³ í™”ì§ˆ ì´ë¯¸ì§€ ì˜¤ë²„ë ˆì´ */}
      {!fullImage.isLoading && (
        <Image 
          source={{ uri: fullImage.optimizedUri }}
          style={styles.image}
        />
      )}
    </View>
  );
}
```

### 3. ìºì‹œ ê´€ë¦¬
```javascript
// ìºì‹œ í¬ê¸° ì œí•œ ë° ì •ë¦¬
const clearOldCache = async () => {
  try {
    const keys = await AsyncStorage.getAllKeys();
    const optimizedKeys = keys.filter(key => key.startsWith('optimized_'));
    
    // 30ì¼ ì´ìƒ ëœ ìºì‹œ ì‚­ì œ
    const thirtyDaysAgo = Date.now() - (30 * 24 * 60 * 60 * 1000);
    
    for (const key of optimizedKeys) {
      const data = await AsyncStorage.getItem(key);
      // ìºì‹œ ë©”íƒ€ë°ì´í„°ì™€ í•¨ê»˜ ì €ì¥í–ˆë‹¤ë©´ ë‚ ì§œ ì²´í¬
      // ì˜¤ë˜ëœ ìºì‹œ ì‚­ì œ
    }
  } catch (error) {
    console.error('ìºì‹œ ì •ë¦¬ ì‹¤íŒ¨:', error);
  }
};
```

### 4. WebP í¬ë§· í™œìš©
```javascript
// WebPëŠ” JPEGë³´ë‹¤ 30% ë” ì‘ì€ í¬ê¸°
const { optimizedUri } = useOptimizedImage(
  imageUrl,
  itemId,
  {
    width: 200,
    height: 150,
    quality: 0.7,
    format: ImageManipulator.SaveFormat.WEBP, // WebP ì‚¬ìš©
  }
);
```

## ì£¼ì˜ì‚¬í•­ê³¼ ìµœì í™” íŒ

### 1. ë©”ëª¨ë¦¬ ê´€ë¦¬
```javascript
// ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ ì •ë¦¬
useEffect(() => {
  return () => {
    // í•„ìš”ì‹œ ì„ì‹œ íŒŒì¼ ì •ë¦¬
    ImageManipulator.cleanupAsync?.();
  };
}, []);
```

### 2. ë°°ì¹˜ ì²˜ë¦¬
```javascript
// ì—¬ëŸ¬ ì´ë¯¸ì§€ë¥¼ í•œ ë²ˆì— ìµœì í™”
const optimizeMultipleImages = async (images) => {
  const promises = images.map(image => 
    ImageManipulator.manipulateAsync(
      image.uri,
      [{ resize: { width: 200, height: 150 } }],
      { compress: 0.7 }
    )
  );
  
  return Promise.all(promises);
};
```

### 3. ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ê³ ë ¤
```javascript
import NetInfo from '@react-native-community/netinfo';

// WiFiì—ì„œë§Œ ê³ í™”ì§ˆ ì´ë¯¸ì§€ ë¡œë“œ
const { isConnected, type } = await NetInfo.fetch();
const quality = type === 'wifi' ? 0.8 : 0.6;
```

## ì‹¤ì œ êµ¬í˜„ ê²°ê³¼

ì´ ì†”ë£¨ì…˜ì„ ì ìš©í•œ í›„:
- **ì²« ë¡œë”©**: ì•½ê°„ì˜ ì²˜ë¦¬ ì‹œê°„ í•„ìš” (0.5-1ì´ˆ)
- **ì¬ë°©ë¬¸**: AsyncStorage ìºì‹œë¡œ ì¦‰ì‹œ ë¡œë”©
- **ë©”ëª¨ë¦¬ íš¨ìœ¨**: 99% ìš©ëŸ‰ ê°ì†Œë¡œ ë©”ëª¨ë¦¬ ë¶€ë‹´ ìµœì†Œí™”
- **ì‚¬ìš©ì ê²½í—˜**: í™”ë©´ ì „í™˜ê³¼ ìŠ¤í¬ë¡¤ì´ ë„¤ì´í‹°ë¸Œ ì•±ì²˜ëŸ¼ ë¶€ë“œëŸ¬ì›€

## ê²°ë¡ 

expo-image-manipulatorì™€ AsyncStorageë¥¼ í™œìš©í•œ ì´ë¯¸ì§€ ìµœì í™”ëŠ” React Native ì•±ì˜ ì„±ëŠ¥ì„ ê·¹ì ìœ¼ë¡œ í–¥ìƒì‹œí‚¨ë‹¤. íŠ¹íˆ:

1. **ì‹¤ì‹œê°„ ì••ì¶•**: ì‚¬ìš©ìê°€ í•„ìš”ë¡œ í•  ë•Œë§Œ ì´ë¯¸ì§€ ì²˜ë¦¬
2. **ì˜êµ¬ ìºì‹±**: í•œ ë²ˆ ì²˜ë¦¬í•œ ì´ë¯¸ì§€ëŠ” ì¬ì‚¬ìš©
3. **ìœ ì—°í•œ ì˜µì…˜**: ìƒí™©ì— ë§ëŠ” í¬ê¸°ì™€ í’ˆì§ˆ ì„ íƒ

Firebase Storage URL íŒŒë¼ë¯¸í„° ê°™ì€ ì™¸ë¶€ ì„œë¹„ìŠ¤ì— ì˜ì¡´í•˜ì§€ ì•Šê³ , ì•± ë‚´ì—ì„œ ì™„ì „íˆ ì œì–´í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ ê°€ì¥ í° ì¥ì ì´ë‹¤. 

ì´ì œ 5MB ì´ë¯¸ì§€ë„ ë‘ë µì§€ ì•Šë‹¤. ì‚¬ìš©ìë“¤ì€ ë¹ ë¥¸ ë¡œë”©ê³¼ ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜ì„ ê²½í—˜í•˜ê³ , ê°œë°œìëŠ” ì„±ëŠ¥ ê±±ì • ì—†ì´ ê³ í™”ì§ˆ ì´ë¯¸ì§€ë¥¼ ììœ ë¡­ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.